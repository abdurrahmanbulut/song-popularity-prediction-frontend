(function(t){function e(e){for(var a,o,n=e[0],c=e[1],l=e[2],p=0,h=[];p<n.length;p++)o=n[p],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&h.push(r[o][0]),r[o]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);u&&u(e);while(h.length)h.shift()();return i.push.apply(i,l||[]),s()}function s(){for(var t,e=0;e<i.length;e++){for(var s=i[e],a=!0,n=1;n<s.length;n++){var c=s[n];0!==r[c]&&(a=!1)}a&&(i.splice(e--,1),t=o(o.s=s[0]))}return t}var a={},r={app:0},i=[];function o(e){if(a[e])return a[e].exports;var s=a[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=t,o.c=a,o.d=function(t,e,s){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(s,a,function(e){return t[e]}.bind(null,a));return s},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],c=n.push.bind(n);n.push=e,n=n.slice();for(var l=0;l<n.length;l++)e(n[l]);var u=c;i.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"001b":function(t,e,s){"use strict";s("e8aa")},"08fc":function(t,e,s){"use strict";s("a4a5")},"0930":function(t,e,s){t.exports=s.p+"img/search.df01ab7c.svg"},"0b7a":function(t,e,s){"use strict";s("ea35")},1:function(t,e){},1785:function(t,e,s){t.exports=s.p+"img/close-icon.587ff61c.svg"},"257e":function(t,e,s){},"456b":function(t,e,s){},"54e1":function(t,e,s){"use strict";s("8df7")},"56d7":function(t,e,s){"use strict";s.r(e);var a=s("2b0e"),r=s("8c4f"),i=s("2f62");s("13d5");const o=t=>t.slice(1).split("&").reduce((t,e)=>{const[s,a]=e.split("=");return t[s]=a,t},{}),n=(t,e)=>{try{e&&(t.defaults.headers.common["Authorization"]="Bearer "+e)}catch(s){console.log("Error setting auth",s)}},c=t=>{try{delete t.defaults.headers.common["Authorization"]}catch(e){console.log("Error resetting auth",e)}},l=t=>(new Date).getTime()+1e3*parseInt(t),u=t=>(new Date).getTime()>t,{VUE_APP_CLIENT_ID:p,VUE_APP_AUTHORIZE_URL:h,VUE_APP_REDIRECT_URI:d}=Object({NODE_ENV:"production",VUE_APP_AUTHORIZE_URL:"https://accounts.spotify.com/authorize",VUE_APP_CLIENT_ID:"1dd0f29b2e22470c8fe584c211cea5a0",VUE_APP_REDIRECT_URI:"https://song-popularity-predicti-a4112.web.app/callback/",VUE_APP_SEARCH_ENDPOINT:"https://api.spotify.com/v1/search",BASE_URL:"/"}),_={status:"",token:localStorage.getItem("spotify-access-token")||"",tokenExpirationTime:localStorage.getItem("tokenExpirationTime")||""},m={AUTH_REQUEST(t){t.status="loading"},AUTH_SUCCESS(t,e){t.status="logged",t.token=e.token,t.tokenExpirationTime=e.expirationTime,localStorage.setItem("spotify-access-token",e.token),localStorage.setItem("tokenExpirationTime",e.expirationTime),n(this._vm.$http,e.token)},AUTH_ERROR(t){t.status="error"},LOGOUT(t){t.status="",t.token="",t.tokenExpirationTime="",localStorage.removeItem("spotify-access-token"),localStorage.removeItem("tokenExpirationTime"),c(this._vm.$http)}},f={requestAuth:({commit:t})=>new Promise(e=>{t("AUTH_REQUEST"),window.location=`${h}?client_id=${p}&redirect_uri=${d}&response_type=token`,e()}),manageSuccessfulAuth:({commit:t},e)=>new Promise(s=>{const{access_token:a,expires_in:r}=o(e),i={token:a,expirationTime:l(r)};t("AUTH_SUCCESS",i),s()}),manageFailedAuth:({commit:t})=>{t("AUTH_ERROR")},logout:({commit:t})=>{t("LOGOUT")}},v={token:t=>t.token,isAuthenticated:t=>!!t.token&&!u(t.tokenExpirationTime),authStatus:t=>t.status,hasTokenExpired:t=>!t.tokenExpirationTime||u(t.tokenExpirationTime)};var y={state:_,mutations:m,actions:f,getters:v},g=s("4328"),T=s.n(g);const{VUE_APP_SEARCH_ENDPOINT:S}=Object({NODE_ENV:"production",VUE_APP_AUTHORIZE_URL:"https://accounts.spotify.com/authorize",VUE_APP_CLIENT_ID:"1dd0f29b2e22470c8fe584c211cea5a0",VUE_APP_REDIRECT_URI:"https://song-popularity-predicti-a4112.web.app/callback/",VUE_APP_SEARCH_ENDPOINT:"https://api.spotify.com/v1/search",BASE_URL:"/"}),b={results:{},searchStatus:"DONE",searchTerm:""},E={SET_SEARCH_RESULTS(t,e){t.results=JSON.parse(JSON.stringify(e))},SET_SEARCH_STATUS(t,e){t.searchStatus=e},SET_SEARCH_TERM(t,e){t.searchTerm=e},CLEAR_SEARCH_RESULTS(t){t.results={},t.searchTerm=""}},R={async search({commit:t,getters:e},s){try{t("SET_SEARCH_STATUS","SEARCHING"),t("SET_SEARCH_TERM",s.searchTerm);const a=await this._vm.$http.get(S,{headers:{Accept:"application/json","Content-Type":"application/json"},params:{q:e.searchTerm,type:s.type,offset:s.offset||0},paramsSerializer:t=>T.a.stringify(t,{indices:!1})});t("SET_SEARCH_RESULTS",a.data),t("SET_SEARCH_STATUS","DONE")}catch(a){t("SET_SEARCH_STATUS","DONE"),console.log("SEARCH ERROR: "+a)}},clearResults:({commit:t})=>{t("CLEAR_SEARCH_RESULTS")}},A={searchResults:t=>t.results,searchStatus:t=>t.searchStatus,searchTerm:t=>t.searchTerm};var x={state:b,mutations:E,actions:R,getters:A};const C={toasterTimer:null,displayToaster:!1},O={toasterTimer:t=>t.toasterTimer,displayToaster:t=>t.displayToaster},k={DISPLAY_TOASTER(t){t.displayToaster=!0},HIDE_TOASTER(t){t.displayToaster=!1},SET_TIMER(t,e){t.toasterTimer=e},CLEAR_TIMER(t){clearTimeout(t.toasterTimer),t.toasterTimer=null}},w={diplayToaster({commit:t,getters:e}){t("DISPLAY_TOASTER"),null!==e.toasterTimer&&t("CLEAR_TIMER");const s=setTimeout(()=>{t("HIDE_TOASTER"),t("CLEAR_TIMER")},1500);t("SET_TIMER",s)}};var I={state:C,mutations:k,actions:w,getters:O};a["a"].use(i["a"]);var U=new i["a"].Store({modules:{auth:y,search:x,toaster:I}}),P=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("div",{staticClass:"boddy"},[e("transition",{attrs:{name:"toaster"}},[t.showToaster?e("Toaster",[t._v("Feature not available yet")]):t._e()],1),e("router-view")],1)])},j=[],H=(s("14d9"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"container"},[t._m(0),e("spotify-button",{staticClass:"login-btn",nativeOn:{click:function(e){return t.requestAuth.apply(null,arguments)}}},[t._v("Login!")])],1)}),L=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"login-text"},[e("p",[t._v(" Welcome! In order to use this app you need to authorize it by clicking the button below. ")]),e("p",[t._v("You'll be redirected to Spotify Account services for login in")])])}],N=function(){var t=this,e=t._self._c;return e("div",{staticClass:"btn"},[e("span",{staticClass:"btn__text"},[t._t("default",(function(){return[t._v("Login")]}))],2)])},D=[],M={},$=M,V=(s("08fc"),s("2877")),q=Object(V["a"])($,N,D,!1,null,"3fba9cd4",null),z=q.exports,B={name:"Login",components:{SpotifyButton:z},methods:{...Object(i["b"])(["requestAuth"])}},F=B,G=(s("6e8f"),Object(V["a"])(F,H,L,!1,null,"355c287e",null)),J=G.exports,Y=function(){var t=this,e=t._self._c;return e("div",{staticStyle:{display:"flex","flex-direction":"column","justify-content":"center","align-items":"center","margin-top":"4rem","min-height":"100vh",width:"80%"}},[e("div",{staticStyle:{"margin-bottom":"4rem"}},[e("div",[e("SearchBox",{on:{input:t.performSearch},model:{value:t.searchTerm,callback:function(e){t.searchTerm=e},expression:"searchTerm"}})],1)]),t.noResults?e("div",{staticClass:"search__message"},[e("p",[t._v(t._s(t.searchMessage))])]):e("div",{staticClass:"result-style"},t._l(t.results,(function(s){return e("ResultsPanel",{key:s[0].type,attrs:{results:s.slice(0,t.maxResults)},on:{"see-more":t.seeMore}})})),1)])},Q=[],Z=s("f7fe"),W=s.n(Z),K=function(){var t=this,e=t._self._c;return e("div",{staticClass:"searchbox"},[e("svg",{staticClass:"searchbox__icon searchbox__icon--search"},[e("use",{attrs:{"xlink:href":s("0930")+"#search"}})]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.content,expression:"content"}],attrs:{placeholder:"Search music",type:"text",name:"searchbox",id:"searchbox",autofocus:""},domProps:{value:t.content},on:{input:function(e){e.target.composing||(t.content=e.target.value)}}}),""!==t.value?e("div",{staticClass:"searchbox__clear-wrapper",on:{click:t.clear}},[e("svg",{staticClass:"searchbox__icon searchbox__icon--clear"},[e("use",{attrs:{"xlink:href":s("6282")+"#close"}})])]):t._e()])},X=[],tt={components:{},props:{value:{type:String}},computed:{content:{get(){return this.value},set(t){this.$emit("input",t)}}},methods:{clear(){this.content=""}}},et=tt,st=(s("0b7a"),Object(V["a"])(et,K,X,!1,null,"d60cdfcc",null)),at=st.exports,rt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"results",staticStyle:{"margin-bottom":"3rem"}},[e("div",{staticStyle:{"margin-bottom":"3rem","margin-top":"2rem"}},[e("h2",{staticStyle:{color:"black !important","text-align":"center"}},[t._v(t._s(t.typeTitle))])]),t._l(t.results,(function(t){return e("SpotifyCard",{key:t.id,attrs:{cardInfo:t}})}))],2)},it=[],ot=function(){var t=this,e=t._self._c;return t.playSong?e("div",{},[e("div",{staticStyle:{width:"100%","min-height":"25rem",display:"flex","flex-direction":"column","justift-content":"space-between"}},[e("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"}},[e("iframe",{attrs:{id:"spotify-music",src:this.newUrl,width:"90%",height:"80px",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy"}}),e("div",{staticStyle:{width:"10%",display:"flex","justify-content":"center","align-items":"center"}},[e("img",{staticStyle:{cursor:"pointer",width:"2rem"},attrs:{src:s("1785"),alt:""},on:{click:function(e){return t.changeSpotifyCard()}}})])]),e("div",{staticClass:"song-info-card"},[e("div",{staticClass:"song-info-subcard"},[e("table",{staticClass:"feature-table"},[e("tr",[e("th",[t._v("acousticness:")]),e("td",[t._v(t._s(this.audio_features.acousticness))])]),e("tr",[e("th",[t._v("danceability:")]),e("td",[t._v(t._s(this.audio_features.danceability))])]),e("tr",[e("th",[t._v("duration_ms:")]),e("td",[t._v(t._s(this.audio_features.duration_ms))])]),e("tr",[e("th",[t._v("energy:")]),e("td",[t._v(t._s(this.audio_features.energy))])]),e("tr",[e("th",[t._v("instrumentalness:")]),e("td",[t._v(t._s(this.audio_features.instrumentalness))])]),e("tr",[e("th",[t._v("liveness:")]),e("td",[t._v(t._s(this.audio_features.liveness))])]),e("tr",[e("th",[t._v("loudness:")]),e("td",[t._v(t._s(this.audio_features.loudness))])]),e("tr",[e("th",[t._v("mode:")]),e("td",[t._v(t._s(this.audio_features.mode))])]),e("tr",[e("th",[t._v("speechiness:")]),e("td",[t._v(t._s(this.audio_features.speechiness))])]),e("tr",[e("th",[t._v("tempo:")]),e("td",[t._v(t._s(this.audio_features.tempo))])]),e("tr",[e("th",[t._v("time_signature:")]),e("td",[t._v(t._s(this.audio_features.time_signature))])]),e("tr",[e("th",[t._v("valence:")]),e("td",[t._v(t._s(this.audio_features.valence))])]),e("tr",[e("th",[t._v("explicit:")]),e("td",[t._v(t._s(this.album_features.explicit))])]),e("tr",[e("th",[t._v("valence:")]),e("td",[t._v(t._s(this.audio_features.valence))])]),e("tr",[e("th",[t._v("release_date:")]),e("td",[t._v(t._s(this.album_features.album.release_date.substring(0,4)))])])])]),e("div",{staticStyle:{width:"100%",display:"flex","flex-direction":"column","align-items":"center"}},[e("br"),t._v(" "),e("br"),e("label",{attrs:{for:"actual-popularity"}},[t._v("Actual popularity")]),t._v(" "),e("br"),e("div",{staticClass:"animated-progress progress-white"},[e("span",{staticStyle:{color:"black"}},[t._v(" "+t._s(this.actual_popularity)+"%")])]),e("br"),t._v(" "),e("br"),e("label",{attrs:{for:"predicted-popularity"}},[t._v("Predicted popularity")]),t._v(" "),e("br"),e("div",{staticClass:"animated-progress progress-white"},[e("span",{staticStyle:{color:"black"}},[t._v(" "+t._s(this.actual_popularity)+"%")])]),e("br"),t._v(" "),e("br"),e("div",{staticStyle:{width:"70%",height:"30px","border-radius":"5px",display:"flex","justify-content":"space-between"}},[t._m(0),e("div",{staticStyle:{width:"30%"}},[e("button",{staticStyle:{width:"100%",height:"100%"},on:{click:t.predict}},[t._v("Predict")])])])])])])]):t.playSong?t._e():e("div",{staticClass:"spotify-card",on:{click:t.handleCardClick}},[e("div",{staticClass:"spotify-card__picture"},[e("img",{staticStyle:{"border-radius":"10%",height:"100%"},attrs:{src:t.imageURL,alt:"placeholder"}})]),e("div",{staticClass:"spotify-card__info",staticStyle:{padding:"1rem"}},[e("span",{staticClass:"spotify-card__title"},[t._v(t._s(t.cardTitle))]),e("span",{staticClass:"spotify-card__subtitle"},[t._v(t._s(t.cardSubtitle))])])])},nt=[function(){var t=this,e=t._self._c;return e("div",{staticStyle:{width:"50%"}},[e("input",{staticStyle:{width:"100%",height:"100%"},attrs:{type:"number",min:"1920",max:"2022",step:"1",value:"2016",placeholder:"year: yyyy"}})])}],ct=s("bc3a"),lt=s.n(ct),ut={props:{cardInfo:{type:Object,required:!0}},data(){return{cardType:this.cardInfo.type,cardTitle:this.cardInfo.name,playSong:!1,newUrl:"",actual_popularity:0,posts:[],audio_features:{},album_features:{}}},computed:{imageURL(){var t,e,a;return("track"===this.cardType?null===(t=this.cardInfo.album)||void 0===t||null===(e=t.images[1])||void 0===e?void 0:e.url:null===(a=this.cardInfo.images[1])||void 0===a?void 0:a.url)||s("70de")},cardSubtitle(){let t="";return"track"==this.cardType&&(t=this.cardInfo.artists.map(t=>t.name).join(", ")),t}},methods:{...Object(i["b"])(["diplayToaster"]),handleCardClick(){if(console.log("vard info",this.cardInfo),this.actual_popularity=this.cardInfo.popularity,"track"==this.cardInfo.type){const t=this.cardInfo.external_urls.spotify.split("com/");this.newUrl=t[0]+"com/embed/"+t[1],this.playSong=!0}this.getPosts(this.cardInfo),this.album_features=this.cardInfo},predict(){},getPosts(t){lt()({method:"get",url:"https://api.spotify.com/v1/audio-features?ids="+t.id,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("spotify-access-token")}}).then(t=>{this.audio_features=t.data.audio_features[0]})},changeSpotifyCard(){console.log(this.playSong),this.playSong=!1,console.log(this.playSong)}}},pt=ut,ht=(s("6e30"),Object(V["a"])(pt,ot,nt,!1,null,"e46f678e",null)),dt=ht.exports,_t={components:{SpotifyCard:dt},props:{results:{type:Array,required:!0},showSeeMore:{type:Boolean,default:!1}},computed:{type(){var t;return(null===(t=this.results[0])||void 0===t?void 0:t.type)||""},typeTitle(){const t=this.type?("track"===this.type?"song":this.type)+"s":"";return t.charAt(0).toUpperCase()+t.slice(1)}},methods:{seeMoreClicked(){this.$emit("see-more",this.type)}}},mt=_t,ft=(s("c3d0"),Object(V["a"])(mt,rt,it,!1,null,"34acef25",null)),vt=ft.exports,yt={components:{SearchBox:at,ResultsPanel:vt},data(){return{searchTerm:"",filters:["track"],maxResults:50}},computed:{...Object(i["c"])(["searchResults","searchStatus"]),results(){const t=this.searchResults;return Object.keys(t).filter(e=>t[e].items.length>0).map(e=>t[e].items)},noResults(){return"SEARCHING"!==this.searchStatus&&this.results.length<1},searchMessage(){return""===this.searchTerm?"Type something to start searching":"😰 Oops! No results found..."}},methods:{...Object(i["b"])(["search","clearResults"]),performSearch:W()((function(){if(""!==this.searchTerm){const t={searchTerm:this.searchTerm,type:this.filters.join(",")};this.search(t)}else this.clearResults()}),200),seeMore(t){wt.push({name:"results",params:{type:t}})}},mounted(){this.$store.getters.searchTerm&&this.searchResults&&(this.searchTerm=this.$store.getters.searchTerm,this.performSearch())}},gt=yt,Tt=(s("001b"),Object(V["a"])(gt,Y,Q,!1,null,"4e7faf53",null)),St=Tt.exports,bt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"redirect_page"},[e("div",{staticClass:"container"},[e("h2",[t._v("😰 Oops! Something went wrong...")]),t.errorMessage?e("p",{staticClass:"error"},[t._v("Error: "+t._s(t.errorMessage))]):t._e(),e("p",[t._v("You will be redirected soon")]),e("p",[t._v("Try to login again")])])])},Et=[],Rt={computed:{errorMessage(){return this.$route.query.error||""}},methods:{...Object(i["b"])(["manageSuccessfulAuth","manageFailedAuth"])},mounted:async function(){const t=this.$route;t.hash?(await this.manageSuccessfulAuth(t.hash),wt.push({path:"/search"})):(this.manageFailedAuth(),setTimeout(()=>{wt.push({name:"login"})},2500))}},At=Rt,xt=(s("86b3"),Object(V["a"])(At,bt,Et,!1,null,"00941cdc",null)),Ct=xt.exports;const Ot=[{path:"/",redirect:"/search"},{path:"/login",name:"login",component:J},{path:"/redirect",name:"redirect",component:Ct},{path:"/search",name:"search",component:St,meta:{requiresAuth:!0}}],kt=new r["a"]({mode:"history",routes:Ot});kt.beforeEach((t,e,s)=>{if(t.matched.some(t=>t.meta.requiresAuth)){if(U.getters.isAuthenticated)return void s();s({name:"login"})}else s()});var wt=kt,It=function(){var t=this,e=t._self._c;return e("div",{staticClass:"toaster"},[e("span",[t._t("default")],2)])},Ut=[],Pt={},jt=Pt,Ht=(s("ea65"),Object(V["a"])(jt,It,Ut,!1,null,"4540812f",null)),Lt=Ht.exports,Nt={name:"App",components:{Toaster:Lt},created(){this.$http.interceptors.response.use(t=>t,t=>{if(401===t.response.status)throw console.log("Token expired!"),this.logout(),wt.push({name:"login"}),t;return Promise.reject(t)})},mounted(){this.$store.getters.isAuthenticated?n(this.$http,this.$store.getters.token):this.logout()},computed:{...Object(i["c"])(["displayToaster"]),showToaster(){return this.displayToaster}},methods:{...Object(i["b"])(["logout"])}},Dt=Nt,Mt=(s("54e1"),Object(V["a"])(Dt,P,j,!1,null,"055fd312",null)),$t=Mt.exports,Vt=s("9ea2");s("b089");a["a"].prototype.$http=lt.a.create(),a["a"].config.productionTip=!1,a["a"].use(r["a"]),a["a"].use(Vt["a"]),new a["a"]({render:t=>t($t),router:wt,store:U}).$mount("#app")},6282:function(t,e,s){t.exports=s.p+"img/close.f8d80b24.svg"},"6e30":function(t,e,s){"use strict";s("9535")},"6e8f":function(t,e,s){"use strict";s("456b")},"70de":function(t,e,s){t.exports=s.p+"img/img-placeholder.725afb83.jpg"},"86b3":function(t,e,s){"use strict";s("98c1")},"8df7":function(t,e,s){},9535:function(t,e,s){},"98c1":function(t,e,s){},a4a5:function(t,e,s){},b089:function(t,e,s){t.exports={"grid-container":"main_grid-container_3nU92",search__results:"main_search__results_3PQFt"}},c3d0:function(t,e,s){"use strict";s("257e")},c424:function(t,e,s){},e8aa:function(t,e,s){},ea35:function(t,e,s){},ea65:function(t,e,s){"use strict";s("c424")}});
//# sourceMappingURL=app.cc6ae811.js.map